<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8" />
    <title></title>
    <script src="https://lgiacomazzi.github.io/produttare/js_base_produttare.js"></script>
  </head>
  <body>
    <section class="container pt-4">
      <h1>Calculadora OEE MVP</h1>
      <form>
        <div class="form-group">
          <label for="segmento">Segmento de Atuação</label>
          <select class="form-control" id="segmento">
            <option>Alimentos e Bebidas</option>
            <option>Autopeças </option>
            <option>Construção Civil </option>
            <option>Eletro & Eletrônicos </option>
            <option>Montadoras </option>
            <option>Móveis </option>
            <option>Brinquedos </option>
            <option>Têxtil e Varejo </option>
            <option>Automotiva </option>
            <option>Eletrônicos </option>
            <option>Semicondutores </option>
            <option>Plásticos </option>
            <option>Fundição </option>
            <option>Aeroespacial & Defesa </option>
            <option>Metal Mecânico </option>
            <option>Maquinas e Equipamentos </option>
            <option>Petroquimico </option>
            <option>Produtos Médicos </option>
            <option>Outros (industry average) </option>
          </select>
        </div>
        <div class="form-group">
          <label for="calendario">Calendário de Produção (Minutos)</label>
          <input
            type="number"
            class="form-control"
            id="calendario"
            placeholder="0"
          />
        </div>
        <div class="form-group">
          <label for="paradasp">Paradas Programadas(Minutos)</label>

          <input
            type="number"
            class="form-control"
            id="paradasp"
            placeholder="0"
          /><small>
            Tempo que é dedicado a dedicado a eventos programados tais como:
            (refeições, manutenções planejadas, reuniões, treinamentos,
            etc...)</small
          >
        </div>
        <div class="form-group">
          <label for="paradasnp">Paradas Não Programadas(Minutos)</label>
          <input
            type="number"
            class="form-control"
            id="paradasnp"
            placeholder="0"
          /><small>
            Tempo gasto em eventos não programados tais como: (quebra de
            máquina, falta de matéria-prima, falta de energia, etc...)</small
          >
        </div>
        <div class="form-group">
          <label for="tempo">Tempo padrão 1 item(Minutos)</label>
          <input
            type="number"
            class="form-control"
            id="tempo"
            placeholder="0"
          /><small>
            É definido pela engenharia de produção como o tempo necessário para
            que um recurso execute uma operação no processo na fabricação de um
            produto. )</small
          >
        </div>
        <div class="form-group">
          <label for="qnt">Produção(Unidades)</label>
          <input
            type="number"
            class="form-control"
            id="qnt"
            placeholder="0"
          /><small
            >Refere-se a quantidade de itens que foram fabricados no recurso que
            esta sendo monitorado, no tempo que está sendo levado em
            consideração.
          </small>
        </div>
        <div class="form-group">
          <label for="refugo">Refugo (Unidades)</label>
          <input
            type="number"
            class="form-control"
            id="refugo"
            placeholder="0"
          /><small
            >Refere-se a quantidade de itens não aprovados que foram fabricados
            no recurso que esta sendo monitorado.</small
          >
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            type="radio"
            name="Radios"
            id="gargalo"
            value="option1"
            checked
          />
          <label class="form-check-label" for="gargalo">
            Máquina Gargalo
          </label>
        </div>
        <div class="form-check">
          <input
            class="form-check-input"
            type="radio"
            name="Radios"
            id="ngargalo"
            value="option2"
          />
          <label class="form-check-label" for="ngargalo">
            Máquina <b>não</b> é gargalo
          </label>
        </div>
        <hr />
        <div class="form-group">
          <label for="totalqnt">Itens Produzidos Mensalmente (Unidades)</label>
          <input
            type="number"
            class="form-control"
            id="totalqnt"
            placeholder="0"
          />
        </div>
        <div class="form-group">
          <label for="price">Margem de Lucro Médio por Item (R$)</label>
          <input
            type="number"
            class="form-control"
            id="price"
            placeholder="0"
          />
        </div>
        <a onclick="calculate()" class="btn btn-primary mb-4 text-white"
          >Submit</a
        >
        <div id="resultados">
          <h2>Resultados</h2>
          <hr />
          <p id="roee">OEE:</p>
          <p id="rdisp">Disponibilidade:</p>
          <p id="rperf">Performance:</p>
          <p id="rquali">Qualidade:</p>
          <hr />
          <p id="segmentoee">OEE Segmento:</p>
          <p id="roeediff">Gap:</p>
          <hr />
          <p id="rpot1">Potencial:</p>
          <p id="rpot2">Potencial por Ponto Percentual:</p>
        </div>
      </form>
    </section>
  </body>
  <script>
    function calculate() {
      // Verifica os inputs
      var segmento = document.getElementById("segmento").value;
      var calendario = Number(document.getElementById("calendario").value);
      var paradasp = Number(document.getElementById("paradasp").value);
      var paradasnp = Number(document.getElementById("paradasnp").value);
      var tempo = Number(document.getElementById("tempo").value);
      var qnt = Number(document.getElementById("qnt").value);
      var refugo = Number(document.getElementById("refugo").value);
      var totalqnt = Number(document.getElementById("totalqnt").value);
      var price = Number(document.getElementById("price").value);
      var gargalo = document.getElementById("gargalo").checked;

      // Calcula variáveis
      var tav = qnt * tempo;
      var tdisp = calendario - paradasp;

      // calcula indicadores
      var oee = tav / tdisp;
      if (gargalo) {
        oee = tav / calendario;
      }
      var disp = (tdisp - paradasnp) / tdisp;
      var quali = 1 - refugo / qnt;
      var perf = oee / (disp * quali);
      var benchmark = 0;

      // Verifica o segmento
      if (segmento === "Alimentos e Bebidas") {
        benchmark = 0.85;
      } else if (segmento === "Autopeças") {
        benchmark = 0.85;
      } else if (segmento === "Construção Civil") {
        benchmark = 0.76;
      } else if (segmento === "Eletro & Eletrônicos") {
        benchmark = 0.9;
      } else if (segmento === "Montadoras") {
        benchmark = 0.9;
      } else if (segmento === "Móveis") {
        benchmark = 0.76;
      } else if (segmento === "Brinquedos") {
        benchmark = 0.85;
      } else if (segmento === "Têxtil e Varejo") {
        benchmark = 0.9;
      } else if (segmento === "Semicondutores") {
        benchmark = 0.9;
      } else if (segmento === "Plásticos") {
        benchmark = 0.9;
      } else if (segmento === "Fundição") {
        benchmark = 0.76;
      } else if (segmento === "Aeroespacial & Defesa") {
        benchmark = 0.76;
      } else if (segmento === "Metal Mecânico") {
        benchmark = 0.85;
      } else if (segmento === "Maquinas e Equipamentos") {
        benchmark = 0.85;
      } else if (segmento === "Petroquimico") {
        benchmark = 0.95;
      } else if (segmento === "Produtos Médicos") {
        benchmark = 0.91;
      } else if (segmento === "Outros (industry average)") {
        benchmark = 0.85;
      }

      var tempoAgregacao = 0;
      var tempoCalendario = 0;
      var tempoAgregacaoBenchmark = 0;
      var tempoCalendarioBenchmark = 0;
      var potencialCrescimento = 0;
      var potencialProducao = 0;
      var potencialGanho = 0;
      var ganhoPercentual = 0;

      // Se oee > benchmark seguir
      if (benchmark > oee) {
        tempoAgregacao = totalqnt * tempo;
        tempoCalendario = tempoAgregacao / oee;
        tempoAgregacaoBenchmark = benchmark * tempoCalendario;
        tempoCalendarioBenchmark = tempoAgregacaoBenchmark / tempo;
        potencialCrescimento = benchmark - oee;
        potencialProducao = tempoAgregacaoBenchmark - tempoAgregacao;
        potencialGanho = potencialProducao * price;
        ganhoPercentual = potencialGanho / (100 * potencialCrescimento);
      }

      document.getElementById("segmentoee").innerHTML =
        "OEE Segmento: " + benchmark;
      document.getElementById("roee").innerHTML =
        "OEE: " + (oee * 100).toFixed(2) + " %";
      document.getElementById("roeediff").innerHTML =
        "Gap: " + (potencialCrescimento * 100).toFixed(2) + " %";
      document.getElementById("rdisp").innerHTML =
        "Disponibilidade: " + (disp * 100).toFixed(2) + " %";
      document.getElementById("rperf").innerHTML =
        "Performance: " + (perf * 100).toFixed(2) + " %";
      document.getElementById("rquali").innerHTML =
        "Qualidade: " + (quali * 100).toFixed(2) + " %";
      document.getElementById("rpot1").innerHTML =
        "Potencial: R$" + potencialGanho.toFixed(2);
      document.getElementById("rpot2").innerHTML =
        "Potencial: R$" + ganhoPercentual.toFixed(2);
    }
  </script>
</html>
